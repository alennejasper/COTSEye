{% extends "officer/control/index/index.html" %}

{% block content %}
<div class="container-fluid mt-3">

    <div class="d-flex justify-content-end">
        <button style="background-color: rgb(30, 173, 95);" onclick="window.location.href='{% url 'Officer Control Add Announcement' %}'" class="btn btn-primary mt-4">ADD NEW</button>
    </div>

    <div class="card mt-4">
        <div style="text-align: center; font-weight: 500; font-size: larger;" class="card-header bg-primary text-white">MANAGE STATUS</div>
        <div class="card-body">
            <table class="table table-bordered table-striped">
                <thead class="thead-dark">
                    <tr>
                        <th>Status</th>
                        <th>Location</th>
                        <th>Number of COTS</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="sightingsTable">
                    <!-- Sightings will be added here dynamically -->
                </tbody>
            </table>
            <nav aria-label="Page navigation example">
                <ul class="pagination justify-content-center" id="pagination">
                    <li class="page-item" id="previousPage">
                        <a class="page-link" href="#" onclick="changePage('prev')">Previous</a>
                    </li>
                    <!-- Page numbers will be inserted here by JavaScript -->
                    <li class="page-item" id="nextPage">
                        <a class="page-link" href="#" onclick="changePage('next')">Next</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const sightings = [
            { id: 1, status: "Pending", location: "Location 1", cots: 5 },
            { id: 2, status: "Valid", location: "Location 2", cots: 3 },
            { id: 3, status: "Invalid", location: "Location 3", cots: 7 },
            { id: 4, status: "Pending", location: "Location 4", cots: 2 },
            { id: 5, status: "Valid", location: "Location 5", cots: 4 },
            { id: 6, status: "Invalid", location: "Location 6", cots: 6 },
            { id: 7, status: "Pending", location: "Location 7", cots: 1 },
            { id: 8, status: "Valid", location: "Location 8", cots: 9 },
            { id: 9, status: "Invalid", location: "Location 9", cots: 8 },
            { id: 10, status: "Pending", location: "Location 10", cots: 3 },
            { id: 11, status: "Valid", location: "Location 11", cots: 5 },
            { id: 12, status: "Invalid", location: "Location 12", cots: 7 },
            { id: 13, status: "Pending", location: "Location 13", cots: 2 },
            { id: 14, status: "Valid", location: "Location 14", cots: 4 },
            { id: 15, status: "Invalid", location: "Location 15", cots: 6 },
            { id: 16, status: "Pending", location: "Location 16", cots: 1 },
            { id: 17, status: "Valid", location: "Location 17", cots: 9 },
            { id: 18, status: "Invalid", location: "Location 18", cots: 8 },
            { id: 19, status: "Pending", location: "Location 19", cots: 3 },
            { id: 20, status: "Valid", location: "Location 20", cots: 5 }
        ];

        let currentPage = 1;
        const itemsPerPage = 10;

        function displaySightings(page) {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedSightings = sightings.slice(startIndex, endIndex);

            let table = document.getElementById('sightingsTable');
            table.innerHTML = '';

            paginatedSightings.forEach((sighting, index) => {
                let row = table.insertRow();
                row.insertCell(0).innerText = sighting.status;
                row.insertCell(1).innerText = sighting.location;
                row.insertCell(2).innerText = sighting.cots;

                let actionsCell = row.insertCell(3);
                let updateButton = document.createElement('button');
                updateButton.innerText = 'Update';
                updateButton.classList.add('btn', 'btn-primary', 'btn-sm', 'mr-2');
                updateButton.addEventListener('click', function() {
                    window.location.href = "{% url 'update_view' 1 %}".replace('1', sightings[startIndex + index].id); // Replace with actual id
                });
                actionsCell.appendChild(updateButton);
            });

            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(sightings.length / itemsPerPage);
            pagination.innerHTML = `
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage('prev')">Previous</a>
                </li>
            `;

            for (let i = 1; i <= totalPages; i++) {
                pagination.innerHTML += `
                    <li class="page-item ${i === currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="changePage(${i})">${i}</a>
                    </li>
                `;
            }

            pagination.innerHTML += `
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage('next')">Next</a>
                </li>
            `;
        }

        window.changePage = function(action) {
            const totalPages = Math.ceil(sightings.length / itemsPerPage);

            if (action === 'prev' && currentPage > 1) {
                currentPage--;
            } else if (action === 'next' && currentPage < totalPages) {
                currentPage++;
            } else if (typeof action === 'number') {
                currentPage = action;
            }

            displaySightings(currentPage);
        };

        displaySightings(currentPage);
    });
</script>
{% endblock %}
