<!DOCTYPE html>
{% load static %}

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="manifest" href="{% static 'templates/webwares/manifest.json' %}">
        <script src="{% static 'templates/webwares/application.js' %}"></script>
        <meta name="theme-color" content="#003755">
        <link rel="apple-touch-icon" href="{% static 'assets/icons/logo (180 x 180).png' %}">
        <meta name="apple-mobile-web-app-status-bar" content="#003755">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
        <link rel="icon" type="image/x-icon" href="{% static 'assets/icons/logo.png' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/index/index.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/home/home.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/post/feed.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/post/read.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/map/map.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/announcement/announcement.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/announcement/read.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/intervention/intervention.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/intervention/read.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/post/post.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/resource/resource.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/inquiry/inquiry.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/report/report.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/profile/profile.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/contributor/service/profile/update.css' %}">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
        <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/exif-js/2.3.0/exif.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
        <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch/dist/geosearch.css"/>
        <script src="https://cdn.jsdelivr.net/npm/leaflet-geosearch/dist/geosearch.min.js"></script>
        <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css"/>
        <script src="https://cdn.jsdelivr.net/npm/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@v0.74.0/dist/L.Control.Locate.min.css"/>
        <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@v0.74.0/dist/L.Control.Locate.min.js" charset="utf-8"></script>
        <script src="https://cdn.jsdelivr.net/npm/apexcharts@latest"></script>
        <title>COTSEye | Home</title>
    </head>

    <body>
        <nav class="navigation-topbar">
            <a href="{% url 'Contributor Service Home' %}" class="logo"><img src="{% static 'assets/logo.png' %}" class="logo"></a>

            <div class="d-flex align-items-center">
                {% include 'contributor/service/index/notification_bell.html' %}
                <a onclick="shownDropdown()" class="profile"><img src="{{ user_profile.profile_photo.url }}" class="drop profile"></a>
            </div>
        </nav>

        <div class="others">
            <div class="dropdown">
                <div id="dropdown-content" class="dropdown-content">
                    <a class="dropdown-header" href="{% url 'Contributor Service Profile' %}">{{ username }}</a>
                    <a href="{% url 'Contributor Service Post' %}" class="dropdown-item"><img src="{% static 'assets/mypost.png' %}">My posts</a>
                    <div class="dropdown-divider"></div>
                    <a href="{% url 'Contributor Service Resource' %}" class="dropdown-item"><img src="{% static 'assets/resource.png' %}">See resources</a>
                    <div class="dropdown-divider"></div>
                    <a href="{% url 'Contributor Service Inquiry' %}" class="dropdown-item"><img src="{% static 'assets/faqs.png' %}">See faqs</a>
                    <div class="dropdown-divider"></div>
                    <a href="{% url 'Contributor Service Logout' %}" class="dropdown-footer">Log out</a>
                </div>
            </div>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function(){
                const element = document.querySelector(".draggable-report");
                let positionX = 0, positionY = 0, offsetX = 0, offsetY = 0;
                let move = false;

                element.onmousedown = function(event){
                    startDrag(event.clientX, event.clientY);
                    document.onmousemove = onMouseMove;
                    document.onmouseup = stopDrag;
                };

                element.ontouchstart = function(event){
                    var touch = event.touches[0];
                    startDrag(touch.clientX, touch.clientY);
                    document.ontouchmove = onTouchMove;
                    document.ontouchend = stopDrag;
                };

                function startDrag(x, y){
                    offsetX = x - element.getBoundingClientRect().left;
                    offsetY = y - element.getBoundingClientRect().top;
                    move = false;
                };

                function onMouseMove(event){
                    moveElement(event.clientX, event.clientY);
                };

                function onTouchMove(event){
                    var touch = event.touches[0];
                    moveElement(touch.clientX, touch.clientY);
                };

                function moveElement(x, y){
                    move = true;
                    positionX = x - offsetX;
                    positionY = y - offsetY;
                    element.style.left = positionX + "px";
                    element.style.top = positionY + "px";
                };

                function stopDrag(){
                    document.onmousemove = document.onmouseup = document.ontouchmove = document.ontouchend = null;
                    if (move){
                        element.onclick = function(event){
                            event.preventDefault();
                        };
                        element.ontouchend = function(event){
                            event.preventDefault();
                        };
                    } else{
                        element.onclick = element.ontouchend = null;
                    }
                };
            });
        </script>
    
        <div class="content">
            {% block content %}
            {% endblock content %}

            <a href="{% url 'Contributor Service Report' %}" class="draggable-report"><img src="{% static 'assets/report.png' %}" class="report"></a>
        </div>

        <nav class="navigation-bottombar">
            <a href="{% url 'Contributor Service Home' %}">
                <img src="{% static 'assets/home.png' %}">
            </a>
            <a href="{% url 'Contributor Service Post Feed' %}">
                <img src="{% static 'assets/cotseye.png' %}">
            </a>
            <a href="{% url 'Contributor Service Map' %}">
                <img src="{% static 'assets/map.png' %}">
            </a>
            <a href="{% url 'Contributor Service Announcement' %}">
                <img src="{% static 'assets/announcement.png' %}">
            </a>
            <a href="{% url 'Contributor Service Intervention' %}">
                <img src="{% static 'assets/intervention.png' %}">
            </a>
        </nav>

        <script>
            function shownDropdown(){
                document.getElementById("dropdown-content").classList.toggle("show");
            }

            window.onclick = function(event){
                if (!event.target.matches("img.drop")){
                    var dropdown = document.getElementsByClassName("dropdown-content");
                    var amount;
                    for (amount = 0; amount < dropdown.length; amount++){
                        var openDropdown = dropdown[amount];
                        if (openDropdown.classList.contains("show")){
                            openDropdown.classList.remove("show");
                        }
                    }
                }
            }
        </script>

        <script type="text/javascript">if(window.location.hash && window.location.hash === "#_=_"){ window.location.hash = ""; history.pushState("", document.title, window.location.pathname);}</script>
    </body>
</html>
